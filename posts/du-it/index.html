<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="My way to du-it.sh" /><meta property="og:locale" content="en" /><meta name="description" content="The other day was maintenance day for my home lab, which mainly means updating docker containers. This time I decided to take a different approach and, rather than using Watchtower, I opened my trusted IDE and created a Bash Script. The reason why I decided to go for a Bash Script is because I had an issue with an update using Watchtower, which basically wiped out the container’s data (luckily that container was in staging). I am sure the issue was not related to Watchtower itself, but it was a bit annoying going through the setup process again. NOTE: Watchtower gives you the option to exclude some containers. Take a look at this for more details. I wanted something very simple (always KISS): while executing the script, I pass the containers’ name as arguments, than the script asks me if I want to Delete or Update them (that’s why DU-it)." /><meta property="og:description" content="The other day was maintenance day for my home lab, which mainly means updating docker containers. This time I decided to take a different approach and, rather than using Watchtower, I opened my trusted IDE and created a Bash Script. The reason why I decided to go for a Bash Script is because I had an issue with an update using Watchtower, which basically wiped out the container’s data (luckily that container was in staging). I am sure the issue was not related to Watchtower itself, but it was a bit annoying going through the setup process again. NOTE: Watchtower gives you the option to exclude some containers. Take a look at this for more details. I wanted something very simple (always KISS): while executing the script, I pass the containers’ name as arguments, than the script asks me if I want to Delete or Update them (that’s why DU-it)." /><link rel="canonical" href="https://www.marcodaleo.com/posts/du-it/" /><meta property="og:url" content="https://www.marcodaleo.com/posts/du-it/" /><meta property="og:site_name" content="Marco D’Aleo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-18T10:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="My way to du-it.sh" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-31T13:10:48+01:00","datePublished":"2022-03-18T10:00:00+00:00","description":"The other day was maintenance day for my home lab, which mainly means updating docker containers. This time I decided to take a different approach and, rather than using Watchtower, I opened my trusted IDE and created a Bash Script. The reason why I decided to go for a Bash Script is because I had an issue with an update using Watchtower, which basically wiped out the container’s data (luckily that container was in staging). I am sure the issue was not related to Watchtower itself, but it was a bit annoying going through the setup process again. NOTE: Watchtower gives you the option to exclude some containers. Take a look at this for more details. I wanted something very simple (always KISS): while executing the script, I pass the containers’ name as arguments, than the script asks me if I want to Delete or Update them (that’s why DU-it).","headline":"My way to du-it.sh","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.marcodaleo.com/posts/du-it/"},"url":"https://www.marcodaleo.com/posts/du-it/"}</script><title>My way to du-it.sh | Marco D'Aleo</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Marco D'Aleo"><meta name="application-name" content="Marco D'Aleo"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/83139333?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Marco D'Aleo</a></div><div class="site-subtitle font-italic">It's a Madhouse</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/kamahell87" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/marco-d-aleo-68a647106/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['info','marcodaleo.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>My way to du-it.sh</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>My way to du-it.sh</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Marco D'Aleo </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Mar 18, 2022, 10:00 AM +0000" >Mar 18, 2022<i class="unloaded">2022-03-18T10:00:00+00:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 31, 2022, 1:10 PM +0100" >Mar 31, 2022<i class="unloaded">2022-03-31T13:10:48+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="365 words">2 min read</span></div></div><div class="post-content"><p>The other day was <em>maintenance day</em> for my home lab, which mainly means updating docker containers. This time I decided to take a different approach and, rather than using <a href="/posts/watchtower-telegram/">Watchtower</a>, I opened my trusted IDE and created a Bash Script.<br /> The reason why I decided to go for a Bash Script is because I had an issue with an update using Watchtower, which basically wiped out the container’s data (luckily that container was in staging). I am sure the issue <strong>was not</strong> related to Watchtower itself, but it was a bit annoying going through the setup process again.<br /> <strong>NOTE:</strong> <em>Watchtower gives you the option to exclude some containers. Take a look at <a href="https://containrrr.dev/watchtower/container-selection/">this</a> for more details.</em><br /> I wanted something very simple (always <a href="https://en.wikipedia.org/wiki/KISS_principle">KISS</a>): while executing the script, I pass the containers’ name as arguments, than the script asks me if I want to <em><strong>D</strong>elete</em> or <em><strong>U</strong>pdate</em> them (that’s why <em>DU-it</em>).</p><p><strong>IMPORTANT:</strong> Keep in mind that this script is based on my lab, where I mainly use <em>docker-compose</em> and every folder is named with the same name of the container, therefore <strong>it may not work in your environment</strong>.</p><h2 id="delete">Delete</h2><p>This option stops and removes the container, it also deletes the image used by that container.<br /> The script will check if the argument provided is a valid match for a container’s name and, if it is, it creates a <em>container_name.tmp</em> file which contains the image used by that container; than, stops and remove that container and <code class="language-plaintext highlighter-rouge">cat</code> out the .tmp file to know what image needs to be deleted. Once done, all the .tmp files will be deleted.</p><h2 id="update">Update</h2><p>This option goes through all the steps of the previous option, but also goes into the container’s directory and executes a <code class="language-plaintext highlighter-rouge">docker-compose up -d</code> so it will pull down the new and updated image.</p><p>As final touch, I gave each option a colour, so I could easily recognise what’s going on if I get distracted doing something else.</p><p>I am sure it can be written in a better way, but at the end of the day it works just fine to me. Also, there’s always room for future improvements.<br /> You can see the script on my GitHub <a href="https://github.com/kamahell87/scripts/blob/main/bash/du-it/du-it.sh">here</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/automation/'>automation</a>, <a href='/categories/scripting/'>scripting</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/du-it/" class="post-tag no-text-decoration" >du-it</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >automation</a> <a href="/tags/bash/" class="post-tag no-text-decoration" >bash</a> <a href="/tags/scripting/" class="post-tag no-text-decoration" >scripting</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=My way to du-it.sh - Marco D'Aleo&url=https://www.marcodaleo.com/posts/du-it/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=My way to du-it.sh - Marco D'Aleo&u=https://www.marcodaleo.com/posts/du-it/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.marcodaleo.com/posts/du-it/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/embracing-the-chaotic-beauty-of-self-hosting/">Embracing the Chaotic Beauty of Self-Hosting: A Love Story</a><li><a href="/posts/du-it/">My way to du-it.sh</a><li><a href="/posts/bookstack/">Documentation, Documentation, Documentation!</a><li><a href="/posts/diun/">DIUN: Docker Image Update Notifier</a><li><a href="/posts/watchtower-telegram/">Watchtower and Telegram notifications</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/self-hosted/">self-hosted</a> <a class="post-tag" href="/tags/ai-generated/">AI-generated</a> <a class="post-tag" href="/tags/alerting/">alerting</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/stories/">stories</a> <a class="post-tag" href="/tags/anniversary/">anniversary</a> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/bash/">bash</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/wireguard-vpn/"><div class="card-body"> <span class="timeago small" >Jan 6, 2022<i class="unloaded">2022-01-06T10:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>WireGuard, VPN made easy</h3><div class="text-muted small"><p> Rather than expose some services in your homelab to the wild public internet, wouldn’t it be better if you can access them safely from anywhere you are? Maybe from your phone? Well, I like the idea...</p></div></div></a></div><div class="card"> <a href="/posts/jellyfin/"><div class="card-body"> <span class="timeago small" >Feb 12, 2022<i class="unloaded">2022-02-12T17:50:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Jellyfin, a versatile media server</h3><div class="text-muted small"><p> Are you looking for another homelab project? Well, why don’t set up a media server? A media server is a nice thing to set up in a homelab, also because it’s something that anyone in the house can u...</p></div></div></a></div><div class="card"> <a href="/posts/diun/"><div class="card-body"> <span class="timeago small" >Mar 11, 2022<i class="unloaded">2022-03-11T16:50:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DIUN: Docker Image Update Notifier</h3><div class="text-muted small"><p> I believe we all agree that automate updates (in general) might not be a good idea. If we are talking about Docker images, we need to monitor the registries to see if a new release is out, than rea...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/diun/" class="btn btn-outline-primary" prompt="Older"><p>DIUN: Docker Image Update Notifier</p></a> <a href="/posts/bookstack/" class="btn btn-outline-primary" prompt="Newer"><p>Documentation, Documentation, Documentation!</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/kamahell87">Marco D'Aleo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/self-hosted/">self hosted</a> <a class="post-tag" href="/tags/ai-generated/">AI generated</a> <a class="post-tag" href="/tags/alerting/">alerting</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/stories/">stories</a> <a class="post-tag" href="/tags/anniversary/">anniversary</a> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/bash/">bash</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
